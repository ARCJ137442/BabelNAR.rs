//! å°è£…ã€Œåç§°åŒ¹é…ã€é€»è¾‘
//! * ðŸŽ¯ç”¨äºŽã€Œè¯­ä¹‰åŒ–ã€ã€Œæ¨¡ç³ŠåŒ–ã€çš„å­—ç¬¦ä¸²åŒ¹é…
//!   * âœ¨æ— è§†å¤§å°å†™åŒ¹é…
//!     * ðŸ“„"opennars"åŒ¹é…"OpenNARS"
//!   * âœ¨ã€Œå«äºŽã€ä¸Žã€ŒåŒ…å«ã€åŒ¹é…
//!     * ðŸ“„"opennars"åŒ¹é…"OpenNARS 3.0.4"ï¼ˆå«äºŽï¼‰ä¸Ž"nars"ï¼ˆåŒ…å«ï¼‰
//!   * âœ¨è¿”å›žä¸€ä¸ªã€ŒåŒ¹é…åº¦ã€çš„æ•°å€¼
//!     * `0`ç»Ÿä¸€è¡¨ç¤ºã€ŒæœªåŒ¹é…ã€
//!     * å‰©ä½™å€¼å¯ç”¨äºŽæŽ’åº

use nar_dev_utils::{first, if_return};

/// åç§°åŒ¹é…
/// * ðŸŽ¯ç”¨äºŽã€Œè¯­ä¹‰åŒ–ã€ã€Œæ¨¡ç³ŠåŒ–ã€çš„å­—ç¬¦ä¸²åŒ¹é…
///   * âœ¨æ— è§†å¤§å°å†™åŒ¹é…
///     * ðŸ“„"opennars"åŒ¹é…"OpenNARS"
///   * âœ¨ã€Œå«äºŽã€ä¸Žã€ŒåŒ…å«ã€åŒ¹é…
///     * ðŸ“„"opennars"åŒ¹é…"OpenNARS 3.0.4"ï¼ˆå«äºŽï¼‰ä¸Ž"nars"ï¼ˆåŒ…å«ï¼‰
/// * âš™ï¸è¿”å›žä¸€ä¸ªã€ŒåŒ¹é…åº¦ã€çš„æ•°å€¼
///   * `0`ç»Ÿä¸€è¡¨ç¤ºã€ŒæœªåŒ¹é…ã€
///   * å‰©ä½™å€¼å¯ç”¨äºŽæŽ’åº
pub fn name_match(name: &str, target: &str) -> usize {
    // å®Œå…¨ç›¸ç­‰â‡’æœ€é«˜çº§
    if_return! {
        // å®Œå…¨ç›¸ç­‰â‡’é«˜
        name == target => 6
        // åŒ…å«äºŽâ‡’ä¸­
        target.contains(name) => 4
        // åŒ…å«â‡’ä½Ž
        name.contains(target) => 2
    }

    // å¿½ç•¥å¤§å°å†™çš„æƒ…å†µ | å¿½ç•¥å¤§å°å†™ï¼Œé™ä¸€ä¸ªåŒ¹é…åº¦
    let name = name.to_lowercase();
    let target = target.to_lowercase();

    first! {
        // å®Œå…¨ç›¸ç­‰â‡’é«˜
        name == target => 5,
        // åŒ…å«äºŽâ‡’ä¸­
        target.contains(&name) => 3,
        // åŒ…å«â‡’ä½Ž
        name.contains(&target) => 1,
        // å¦åˆ™â‡’ä¸åŒ¹é…
        _ => 0,
    }
}

/// åç§°åŒ¹é…/ä»…ã€Œå«äºŽã€
/// * ðŸš©ä¸Ž[`name_match`]ç±»ä¼¼ï¼Œä½†ä»…ã€Œå«äºŽã€è€Œä¸é€‚é…ã€ŒåŒ…å«ã€
/// * ðŸŽ¯ç”¨äºŽã€Œé•¿ä¸²åç§°ä½œä¸ºå†…éƒ¨å…³é”®è¯ã€çš„åŒ¹é…
pub fn name_match_only_contains(name: &str, target: &str) -> usize {
    // å®Œå…¨ç›¸ç­‰â‡’æœ€é«˜çº§
    if_return! {
        // å®Œå…¨ç›¸ç­‰â‡’é«˜
        name == target => 4
        // å«äºŽâ‡’ä½Ž
        target.contains(name) => 2
    }

    // å¿½ç•¥å¤§å°å†™çš„æƒ…å†µ | å¿½ç•¥å¤§å°å†™ï¼Œé™ä¸€ä¸ªåŒ¹é…åº¦
    let name = name.to_lowercase();
    let target = target.to_lowercase();

    first! {
        // å®Œå…¨ç›¸ç­‰â‡’é«˜
        name == target => 3,
        // å«äºŽâ‡’ä½Ž
        target.contains(&name) => 1,
        // å¦åˆ™â‡’ä¸åŒ¹é…
        _ => 0,
    }
}

/// åˆ¤æ–­ã€Œæ˜¯å¦åŒ¹é…ã€ï¼Œä¸ç®¡ã€ŒåŒ¹é…åº¦ã€å¤šå°‘
/// * ðŸš©ç›´æŽ¥å¤ç”¨é€»è¾‘ï¼Œä»¥ç‰ºç‰²ä¸€å®šæ€§èƒ½ä¸ºä»£ä»·
pub fn is_name_match(name: &str, target: &str) -> bool {
    name_match(name, target) > 0
}
